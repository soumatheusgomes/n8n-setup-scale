# n8n Setup - Environment Configuration
#
# Copy to .env and update with your values: cp .env.example .env
#
# Generate passwords:
#   openssl rand -base64 32    # For N8N_ENCRYPTION_KEY, REDIS_PASSWORD, POSTGRES_PASSWORD
#   openssl rand -hex 32       # For N8N_RUNNERS_AUTH_TOKEN
#
# Generate Traefik dashboard auth:
#   echo "admin:$(htpasswd -nbB admin 'PASSWORD' | cut -d: -f2 | sed 's/\$/\$\$/g')"

################################################################################
# n8n Core
################################################################################

# n8n version (major version for automatic minor/patch updates)
N8N_VERSION=2

# Task Runner version (must match n8n major version)
N8N_RUNNER_VERSION=2

# Protocol: https (production with Traefik) or http (local development)
N8N_PROTOCOL=https

# Public hostname (must point to your server)
N8N_HOST=n8n.domain.com

# Encryption key for credentials (32+ chars, NEVER change after setup)
N8N_ENCRYPTION_KEY=

# Timezone (IANA format: America/Sao_Paulo, Europe/London, UTC)
GENERIC_TIMEZONE=America/Sao_Paulo

################################################################################
# Task Runners
################################################################################

# Authentication token for runner communication (32-char hex)
N8N_RUNNERS_AUTH_TOKEN=

# Runners per worker (total = workers x runners_per_worker)
RUNNERS_PER_WORKER=1

################################################################################
# Redis (BullMQ Queue)
################################################################################

# Redis version (major version for automatic updates)
REDIS_VERSION=8

# Redis password
REDIS_PASSWORD=

################################################################################
# PostgreSQL Database
################################################################################

# PostgreSQL version (major version for automatic updates)
POSTGRES_VERSION=18

# Leave empty for local container (profile: dblocal), or set remote host
POSTGRES_HOST=
POSTGRES_PORT=5432
POSTGRES_DB=n8n
POSTGRES_USER=n8n
POSTGRES_PASSWORD=

# SSL validation (false for managed DBs without custom CA)
DB_POSTGRESDB_SSL_REJECT_UNAUTHORIZED=false

################################################################################
# Traefik (TLS/HTTPS)
################################################################################

# Traefik version (major version for automatic updates)
TRAEFIK_VERSION=v3

# Dashboard subdomain
TRAEFIK_DASHBOARD_DOMAIN=traefik.domain.com

# Dashboard auth (htpasswd format)
TRAEFIK_DASHBOARD_AUTH=

################################################################################
# Cloudflare DNS (Let's Encrypt)
################################################################################

# API Token with Zone.DNS Read/Edit permissions
# Create at: https://dash.cloudflare.com/profile/api-tokens
CLOUDFLARE_DNS_API_TOKEN=

# Email for certificate notifications
LETSENCRYPT_EMAIL=your@email.com

################################################################################
# SMTP (Optional)
################################################################################

SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=
SMTP_SENDER_NAME=
SMTP_SENDER_EMAIL=

################################################################################
# Browserless (Optional)
################################################################################

BROWSERLESS_VERSION=latest
BROWSERLESS_TOKEN=

################################################################################
# Advanced Configuration
################################################################################

# External NPM modules (* for all, or comma-separated: axios,lodash)
NODE_FUNCTION_ALLOW_EXTERNAL=

# Execution pruning (auto-delete old executions)
EXECUTIONS_DATA_PRUNE=true
EXECUTIONS_DATA_MAX_AGE=336

# Prometheus metrics
N8N_METRICS=false
N8N_METRICS_PREFIX=n8n_

# Logging (level: error, warn, info, verbose, debug)
N8N_LOG_LEVEL=info
N8N_LOG_OUTPUT=console

# Features
N8N_VERSION_NOTIFICATIONS_ENABLED=true
N8N_TEMPLATES_ENABLED=true
N8N_USER_MANAGEMENT_JWT_DURATION_HOURS=168

# Performance
EXECUTIONS_PROCESS_CONCURRENCY=10
EXECUTIONS_TIMEOUT=-1
N8N_PAYLOAD_SIZE_MAX=16

# System timezone
TZ=America/Sao_Paulo
